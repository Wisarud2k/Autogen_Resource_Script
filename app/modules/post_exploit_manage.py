import os
import pyfiglet
import time

def terminal(client,jobs):
    while True:
        print('press [1] to session')
        print('press [2] to job')
        print('press [0] to go back')
        command = input('Input Command Here: ')
        if(command == '1'):
            os.system('cls' if os.name == 'nt' else 'clear')
            __session_manage(client)
        elif(command == '2'):
            os.system('cls' if os.name == 'nt' else 'clear')
            __jobs_manage(client,jobs)
        elif command == '0':
            os.system('cls' if os.name == 'nt' else 'clear')
            break
        else:
            print('Error: Command Not Found..')

def __session_manage(client):
    while True:
        print(pyfiglet.figlet_format(text = "SESSION",font = "slant"))
        print(f'{len(client.sessions.list)} session(s) running' )
        session_list = client.sessions.list
        session_keys = session_list.keys()
        print('ID\tTYPE\tEXPLOIT\t\t\t\t\t\tPAYLOAD\t\t\t\tTUNNEL')
        for key in session_keys:
            # print(session_list[key])
            session = session_list[key]
            print(key,end='\t')
            print(session['type'],end='\t')
            print("{:48.48}".format(session['via_exploit']),end='')
            print(session['via_payload'],end='\t')
            print(session['tunnel_peer'],end='')
            print()
        print('press [1] to Stop session')
        print('press [2] to Stop all sessions')
        print('press [0] to go back')
        command = input('Input Command Here: ')
        if command == '1':
            #individual stop function
            try:
                session_id = input('Input session Id to Stop: ')
                shell = client.sessions.session(session_id)
                shell.stop()
                os.system('cls' if os.name == 'nt' else 'clear')
            except:
                os.system('cls' if os.name == 'nt' else 'clear')
            
        elif command == '2':
            #stop all sessions
            # print('stop all')
            for s in client.sessions.list.keys():
                # print(s)
                shell = client.sessions.session(s)
                shell.stop()
            time.sleep(2)
            os.system('cls' if os.name == 'nt' else 'clear')
        elif command == '0':
            os.system('cls' if os.name == 'nt' else 'clear')
            break
        else:
            print('Error: Command Not Found..')


def __jobs_manage(client,jobs):
    print('jobs_manage')

def main():
    print('nmap module')
# This line runs the main function
if __name__ == "__main__":
    main()